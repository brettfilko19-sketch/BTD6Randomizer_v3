<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BTD6 Ultimate Planner - Full Roster</title>
    <style>
        :root { --primary: #00d1b2; --bg-card: #1a1c23; --bg-body: #0b0e14; --border: #2d333b; }
        .coop-mode { --primary: #ffdd57; --border: #5d4d8a; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg-body); color: #e0e0e0; padding: 20px; }
        .container { max-width: 900px; margin: auto; background: var(--bg-card); padding: 25px; border-radius: 12px; border: 2px solid var(--border); box-shadow: 0 10px 40px rgba(0,0,0,0.6); }
        h2 { color: var(--primary); text-align: center; text-transform: uppercase; margin-bottom: 5px; }
        .subtitle { text-align: center; color: #7a7a7a; font-size: 0.85em; margin-bottom: 20px; }
        .coop-toggle-container { display: flex; justify-content: center; align-items: center; margin-bottom: 20px; padding: 10px; background: rgba(0,0,0,0.2); border-radius: 8px; }
        .coop-toggle-container label { color: #fff; margin-left: 10px; cursor: pointer; font-size: 0.9em; font-weight: bold; }
        .section-title { color: var(--primary); font-size: 0.8em; letter-spacing: 1px; margin: 20px 0 10px 0; border-bottom: 1px solid var(--border); padding-bottom: 5px; }
        label { display: block; margin-bottom: 5px; color: var(--primary); font-weight: bold; font-size: 0.9em; }
        select, input[type="number"] { width: 100%; padding: 10px; border-radius: 6px; background: #2d333b; color: white; border: 1px solid #3e444d; outline: none; box-sizing: border-box; margin-bottom: 10px; }
        .flex-row { display: flex; gap: 15px; margin-bottom: 10px; }
        .flex-row div { flex: 1; }
        .projector-box { background: rgba(0, 0, 0, 0.4); border: 1px solid var(--border); padding: 15px; border-radius: 8px; margin-bottom: 20px; }
        .projection-result { font-size: 1.3em; color: var(--primary); text-align: center; font-weight: bold; }
        .btn-random { width: 100%; padding: 15px; background: var(--primary); color: #0b0e14; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; margin-bottom: 20px; font-size: 1em; }
        .summary { background: #0b0e14; padding: 20px; border-radius: 10px; border-left: 5px solid var(--primary); }
        .total-box { font-size: 1.8em; text-align: center; margin-top: 10px; padding: 15px; border-radius: 8px; font-weight: bold; }
        .under-budget { border: 2px solid #00d1b2; color: #00d1b2; background: rgba(0, 209, 178, 0.05); }
        .over-budget { border: 2px solid #ff3860; color: #ff3860; background: rgba(255, 56, 96, 0.05); }
        .cost-row { display: flex; justify-content: space-between; border-bottom: 1px solid #2d333b; padding: 8px 0; font-size: 0.95em; }
    </style>
</head>
<body id="mainBody">

<div class="container">
    <h2>CHIMPS Build Planner</h2>
    <div class="subtitle" id="modeSubtitle">Single Player Mode</div>

    <div class="coop-toggle-container">
        <input type="checkbox" id="coopToggle" onchange="toggleCoop()">
        <label for="coopToggle">ðŸ‘¥ 3-Player Co-op (2/3 Share)</label>
    </div>

    <div class="section-title">CASH PROJECTOR (VERIFIED 2025)</div>
    <div class="projector-box">
        <div class="flex-row">
            <div><label>Current Cash</label><input type="number" id="curCash" value="650" oninput="updateUI()"></div>
            <div><label>Current Round</label><input type="number" id="curRound" value="6" min="6" max="100" oninput="updateUI()"></div>
            <div><label>Target Round</label><input type="number" id="futRound" value="100" min="6" max="100" oninput="updateUI()"></div>
        </div>
        <div id="projectionDisplay" class="projection-result">Projected Wallet: $0</div>
    </div>

    <button class="btn-random" onclick="rollRandom()">ðŸŽ² RANDOMIZE BUILD</button>

    <div class="input-group">
        <label>Hero:</label>
        <select id="heroSelect" onchange="updateUI()"></select>
    </div>

    <div class="flex-row">
        <div><label>Tower 1:</label><select id="tower1" onchange="updateUI()"></select></div>
        <div><label>Tower 2:</label><select id="tower2" onchange="updateUI()"></select></div>
    </div>

    <div class="summary">
        <div id="priceReport"></div>
        <div id="totalDisplay" class="total-box">Total: $0</div>
        <div id="saveupAdvice" style="margin-top:15px; font-style: italic; color: #95a5a6; text-align: center;"></div>
    </div>
</div>

<script>
const DATA = {
    heroes: [
        {name:"Quincy", price:585}, {name:"Gwendolin", price:970}, {name:"Striker Jones", price:810}, {name:"Obyn Greenfoot", price:700},
        {name:"Captain Churchill", price:2160}, {name:"Benjamin", price:1295}, {name:"Ezili", price:650}, {name:"Pat Fusty", price:865},
        {name:"Adora", price:1080}, {name:"Admiral Brickell", price:970}, {name:"Etienne", price:920}, {name:"Sauda", price:650},
        {name:"Psi", price:1080}, {name:"Geraldo", price:1325}, {name:"Corvus", price:1325}, {name:"Rosalia", price:1100}, {name:"Silas", price:1200}
    ],
    P: [
        {name:"Dart: Ultra-Jugg", price:18740}, {name:"Dart: PMFC", price:53700}, {name:"Dart: XBM", price:27375},
        {name:"Boomer: Glaive Lord", price:42100}, {name:"Boomer: Perma Charge", price:41250}, {name:"Boomer: MOAB Dom", price:63500},
        {name:"Bomb: Bloon Crush", price:61000}, {name:"Bomb: MOAB Elim", price:31500}, {name:"Bomb: Bomb Blitz", price:40500},
        {name:"Tack: Inferno Ring", price:55500}, {name:"Tack: S-Maelstrom", price:18500}, {name:"Tack: Zone", price:25850},
        {name:"Ice: Super Brittle", price:38500}, {name:"Ice: Absolute Zero", price:26000}, {name:"Ice: Icicle Impale", price:38200},
        {name:"Glue: Solver", price:31000}, {name:"Glue: Glue Storm", price:19500}, {name:"Glue: Super Glue", price:35000}
    ],
    M: [
        {name:"Sniper: Cripple MOAB", price:45000}, {name:"Sniper: Elite Sniper", price:21500}, {name:"Sniper: Elite Def", price:17500},
        {name:"Sub: Energizer", price:37000}, {name:"Sub: Pre-Emptive", price:43000}, {name:"Sub: Sub Commander", price:34000},
        {name:"Boat: Flagship", price:38000}, {name:"Boat: Pirate Lord", price:28000}, {name:"Boat: Trade Empire", price:26000},
        {name:"Ace: Sky Shredder", price:46100}, {name:"Ace: Tsar Bomba", price:38000}, {name:"Ace: Flying Fortress", price:102000},
        {name:"Heli: Apache Prime", price:58000}, {name:"Heli: Special Poperat.", price:32000}, {name:"Heli: Com. Commander", price:38000},
        {name:"Mortar: The Biggest One", price:38000}, {name:"Mortar: Pop and Awe", price:35000}, {name:"Mortar: Blooncineration", price:48000},
        {name:"Dartling: Ray of Doom", price:112000}, {name:"Dartling: MAD", price:72000}, {name:"Dartling: BEZ", price:62000}
    ],
    G: [
        {name:"Wizard: Archmage", price:42500}, {name:"Wizard: WLP", price:65000}, {name:"Wizard: Prince Darkness", price:31800},
        {name:"Super: True Sun God", price:650000}, {name:"Super: Anti-Bloon", price:103000}, {name:"Super: Legend of Night", price:255000},
        {name:"Ninja: Grandmaster", price:52000}, {name:"Ninja: Grand Sabo", price:25000}, {name:"Ninja: Master Bomber", price:44000},
        {name:"Alch: Permabrew", price:72000}, {name:"Alch: Total Transfo", price:51000}, {name:"Alch: BMA", price:54000},
        {name:"Druid: Superstorm", price:75000}, {name:"Druid: Spirit Forest", price:48000}, {name:"Druid: Avatar Wrath", price:52000},
        {name:"Mermonkey: Abyss Lord", price:34500}, {name:"Mermonkey: Popseidon", price:48000}, {name:"Mermonkey: Final Harmonic", price:41200}
    ],
    S: [
        {name:"Spike: Super Mines", price:162500}, {name:"Spike: Carpet Spikes", price:45000}, {name:"Spike: Perma-Spike", price:39500},
        {name:"Village: Prim. Expert", price:32000}, {name:"Village: Homeland", price:55000}, {name:"Village: Monkeyopolis", price:15000},
        {name:"Engi: Sentry Champion", price:36000}, {name:"Engi: Ultraboost", price:115000}, {name:"Engi: XXXL Trap", price:62000},
        {name:"Beast: Megalodon", price:65000}, {name:"Beast: PouÄkai", price:48000}, {name:"Beast: Giganotosaurus", price:82000}
    ]
};

const ROUND_CASH = { 6:650, 40:16771, 60:51200, 80:98717, 100:178909 };

function getCashAtRound(r) {
    if(ROUND_CASH[r]) return ROUND_CASH[r];
    let keys = Object.keys(ROUND_CASH).map(Number).sort((a,b)=>a-b);
    for(let i=0; i<keys.length-1; i++) {
        if(r > keys[i] && r < keys[i+1]) {
            let percent = (r - keys[i]) / (keys[i+1] - keys[i]);
            return Math.floor(ROUND_CASH[keys[i]] + (ROUND_CASH[keys[i+1]] - ROUND_CASH[keys[i]]) * percent);
        }
    }
    return r > 100 ? 178909 : 650;
}

function toggleCoop() {
    const isCoop = document.getElementById('coopToggle').checked;
    document.getElementById('curCash').value = isCoop ? 900 : 650;
    document.getElementById('curRound').value = 6;
    updateUI();
}

function updateUI() {
    const isCoop = document.getElementById('coopToggle').checked;
    const curCash = parseFloat(document.getElementById('curCash').value) || 0;
    const curR = parseInt(document.getElementById('curRound').value) || 6;
    const futR = parseInt(document.getElementById('futRound').value) || 100;

    // In Co-op, the cumulative income starts at $650 baseline but you get $900 personal start.
    // Income earned is from Round 6 end ($650) to Future Round.
    const teamEarnedSinceR6End = getCashAtRound(futR) - 650;
    const teamEarnedSinceCurrentRound = getCashAtRound(futR) - getCashAtRound(curR);
    
    // Logic: Current Cash + (Future Income * 2/3 share)
    const myShare = isCoop ? (teamEarnedSinceCurrentRound * 0.666) : teamEarnedSinceCurrentRound;
    const totalProjected = curCash + myShare;

    document.getElementById('projectionDisplay').innerText = `Projected Wallet: $${Math.floor(totalProjected).toLocaleString()}`;
    document.getElementById('modeSubtitle').innerText = isCoop ? "Co-op Mode (2/3 Team Share)" : "Single Player Mode";
    document.getElementById('mainBody').classList.toggle('coop-mode', isCoop);

    const hero = DATA.heroes[document.getElementById('heroSelect').value];
    const t1 = getTower(document.getElementById('tower1').value);
    const t2 = getTower(document.getElementById('tower2').value);
    const cost = hero.price + t1.price + t2.price;

    document.getElementById('priceReport').innerHTML = `
        <div class="cost-row"><span>${hero.name}</span><span>$${hero.price.toLocaleString()}</span></div>
        <div class="cost-row"><span>${t1.name}</span><span>$${t1.price.toLocaleString()}</span></div>
        <div class="cost-row"><span>${t2.name}</span><span>$${t2.price.toLocaleString()}</span></div>
    `;

    const totalBox = document.getElementById('totalDisplay');
    totalBox.innerText = `Total Build Cost: $${cost.toLocaleString()}`;
    totalBox.className = "total-box " + (cost > totalProjected ? "over-budget" : "under-budget");

    document.getElementById('saveupAdvice').innerHTML = cost > totalProjected 
        ? `ðŸš¨ Short by $${Math.floor(cost - totalProjected).toLocaleString()}`
        : `âœ… Affordable! Surplus: $${Math.floor(totalProjected - cost).toLocaleString()}`;
}

function getTower(val) {
    if(!val) return {name:"None", price:0};
    return DATA[val[0]][val.substring(1)];
}

function populate() {
    const hSel = document.getElementById('heroSelect');
    DATA.heroes.forEach((h, i) => hSel.add(new Option(`${h.name} ($${h.price})`, i)));
    ['tower1', 'tower2'].forEach(id => {
        const s = document.getElementById(id);
        const cats = [{l:"Primary", k:"P"}, {l:"Military", k:"M"}, {l:"Magic", k:"G"}, {l:"Support", k:"S"}];
        cats.forEach(c => {
            const g = document.createElement('optgroup'); g.label = c.l;
            DATA[c.k].forEach((t, i) => g.appendChild(new Option(t.name, c.k + i)));
            s.appendChild(g);
        });
    });
}

function rollRandom() {
    document.getElementById('heroSelect').selectedIndex = Math.floor(Math.random() * DATA.heroes.length);
    const cats = ['P', 'M', 'G', 'S'];
    [1, 2].forEach(num => {
        const cat = cats[Math.floor(Math.random() * 4)];
        const idx = Math.floor(Math.random() * DATA[cat].length);
        document.getElementById('tower' + num).value = cat + idx;
    });
    updateUI();
}

populate();
updateUI();
</script>
</body>
</html>
